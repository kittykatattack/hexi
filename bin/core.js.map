{"version":3,"sources":["core.js"],"names":["hexi","width","height","setup","thingsToLoad","undefined","load","Hexi","assets","interpolationProperties","position","rotation","size","alpha","interpolate","o","charm","Charm","PIXI","dust","Dust","bump","Bump","spriteUtilities","SpriteUtilities","tileUtilities","TileUtilities","gameUtilities","GameUtilities","modulesToUpdate","push","renderer","autoDetectRenderer","noWebGL","CanvasRenderer","WebGLRenderer","canvas","view","tink","Tink","createModulePropertyAliases","Object","defineProperties","bind","get","enumerable","configurable","scaled","backgroundColor","color","border","style","document","body","appendChild","stage","Container","addProperties","_stage","scaleToWindow","scaleBorderColor","scale","pointer","makePointer","state","loadState","Error","setupState","loadingProgress","loadingFile","assetsToLoad","_progressBarAdded","soundObjects","smoothie","Smoothie","engine","root","update","properties","fps","renderFps","tile","validateAssets","start","callbackFunction","findAssets","fileSourcePaths","filter","extension","source","split","pop","fileExtensionArray","indexOf","fontExtensions","fontFiles","length","spanElements","forEach","fontFamily","fontFamilies","newStyle","createElement","fontFace","createTextNode","head","span","innerHTML","display","opacity","Resource","loaders","setExtensionLoadType","LOAD_TYPE","XHR","setExtensionXhrType","XHR_RESPONSE_TYPE","BUFFER","loadProgressHandler","loader","resource","url","progress","reset","add","on","console","log","finishLoadingState","progressBar","remove","element","soundsToDecode","soundsDecoded","soundExtensions","decodeHandler","keys","resources","xhr","soundSprite","makeSound","name","module","paused","TextureCache","utils","filters","dropShadowFilter","DropShadowFilter","asciiFilter","AsciiFilter","alphaMaskFilter","AlphaMaskFilter","bloomFilter","BloomFilter","blurDirFilter","BlurDirFilter","blurFilter","BlurFilter","colorMatrixFilter","ColorMatrixFilter","colorStepFilter","ColorStepFilter","crossHatchFilter","CrossHatchFilter","displacementFilter","DisplacementFilter","dotScreenFilter","DotScreenFilter","grayFilter","GrayFilter","invertFilter","InvertFilter","pixelateFilter","PixelateFilter","sepiaFilter","SepiaFilter","shockwaveFilter","ShockwaveFilter","twistFilter","TwistFilter","rgbSplitFilter","RGBSplitFilter","smartBlurFilter","SmartBlurFilter","tiltShiftFilter","TiltShiftFilter","draggableSprites","pointers","buttons","makeDraggable","makeUndraggable","makeInteractive","keyboard","arrowControl","sprite","speed","createParticles","x","y","spriteFunction","container","numberOfParticles","gravity","randomSpacing","minAngle","maxAngle","minSize","maxSize","minSpeed","maxSpeed","minScaleSpeed","maxScaleSpeed","minAlphaSpeed","maxAlphaSpeed","minRotationSpeed","maxRotationSpeed","create","particleEmitter","interval","particleFunction","emitter","filmstrip","texture","frameWidth","frameHeight","spacing","frame","frames","coordinates","frameSeries","startNumber","endNumber","baseName","colorToRGBA","value","colorToHex","byteToHex","shoot","shooter","angle","bulletSpeed","bulletArray","bulletSprite","shake","magnitude","angular","fadeOut","fadeIn","pulse","minAlpha","slide","endX","endY","type","yoyo","delayBeforeRepeat","breathe","endScaleX","endScaleY","strobe","scaleFactor","startMagnitude","endMagnitude","wobble","scaleFactorX","scaleFactorY","xStartMagnitude","xEndMagnitude","yStartMagnitude","yEndMagnitude","friction","followCurve","pointsArray","totalFrames","walkPath","originalPathArray","loop","delayBetweenSections","walkCurve","pathArray","delayBeforeContinue","removeTween","tweenObject","makeTween","tweensToAdd","tweenProperty","property","startValue","endValue","hitTestPoint","point","hitTestCircle","c1","c2","global","circleCollision","bounce","movingCircleCollision","multipleCircleCollision","arrayOfCircles","rectangleCollision","r1","r2","hitTestRectangle","hitTestCircleRectangle","hitTestCirclePoint","circleRectangleCollision","circlePointCollision","bounceOffSurface","s","hit","a","b","react","extra","contain","compensateForStageSize","outsideBounds","distance","s1","s2","followEase","follower","leader","followConstant","rotateAroundSprite","rotatingSprite","centerSprite","rotateAroundPoint","randomInt","randomFloat","move","wait","worldCamera","world","worldWidth","worldHeight","soundEffect","frequencyValue","attack","decay","volumeValue","panValue","pitchBendAmount","reverse","randomValue","dissonance","echo","reverb","hitTestTile","mapArray","gidToCheck","pointsToCheck","getIndex","tilewidth","tileheight","mapWidthInTiles","getTile","surroundingCells","getPoints","updateMap","spritesToUpdate","byDepth","hitTestIsoTile","getIsoPoints","makeIsoPointer","isoRectangle","fillStyle","addIsoProperties","makeIsoTiledWorld","jsonTiledMap","tileset","tiling","addChild","tilingSprite","content","font","message","text","align","tint","bitmapText","strokeStyle","lineWidth","rectangle","diameter","circle","circular","ax","ay","bx","by","line","button","group","options","batch","columns","rows","cellWidth","cellHeight","centerCell","xOffset","yOffset","makeSprite","grid","makeTiledWorld","addHexiSpriteProperties","object","children","child","padding","flowSprites","spritesToFlow","i","putRight","sprites","Array","spritesArray","putBottom","putLeft","putTop","vx","vy","_layer","_circular","_interact","_draggable","_bumpPropertiesAdded","swapChildren","child1","child2","index1","index2","childIndex","removeChild","nudgeAnchor","axis","anchor","compensateForAnchor","compensateForAnchors","property1","property2","putCenter","halfWidth","halfHeight","compensateForParentPosition","parent","gx","gy","self","getGlobalPosition","xAnchorOffset","yAnchorOffset","set","baseTexture","scaleMode","SCALE_MODES","NEAREST","LINEAR","_previousPivotX","_previousPivotY","sort","layer","splice","radius","setPosition","setScale","xScale","yScale","setPivot","xPivot","yPivot","pivotX","pivotY","defineProperty","window","addEventListener","hexiObject","maxWidth","foregroundColor","backBar","frontBar","percentage","initialized","ratio","Math","round","makeProgressBar","imageFileName","textureAtlasFrameId","jsonFileName","data","xmlFileName","soundFileName"],"mappings":"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","file":"core.js","sourcesContent":["/*\nHexi\n====\n   \nWelcome to Hexi's source code!\nThis file, `core.js` is the glue that holds Hexi together. Most of Hexi's functionality comes\nfrom some external libraries, written for Hexi, that `core.js` instantiates and wires\ntogether. Here are the external libraries that Hexi is currently using:\n\n- [Pixi](https://github.com/pixijs/pixi.js/): The world's fastest 2D WebGL and canvas renderer.\n- [Bump](https://github.com/kittykatattack/bump): A complete suite of 2D collision functions for games.\n- [Tink](https://github.com/kittykatattack/tink): Drag-and-drop, buttons, a universal pointer and other\n  helpful interactivity tools.\n- [Charm](https://github.com/kittykatattack/charm): Easy-to-use tweening animation effects for Pixi sprites.\n- [Dust](https://github.com/kittykatattack/dust): Particle effects for creating things like explosions, fire\n  and magic.\n- [Sprite Utilities](https://github.com/kittykatattack/spriteUtilities): Easier and more intuitive ways to\n  create and use Pixi sprites, as well adding a state machine and animation player\n- [Game Utilities](https://github.com/kittykatattack/gameUtilities): A collection of useful methods for games.\n- [Tile Utilities](https://github.com/kittykatattack/tileUtilities): A collection of useful methods for making tile-based game worlds with [Tiled Editor](http://www.mapeditor.org).\n- [Sound.js](https://github.com/kittykatattack/sound.js): A micro-library for loading, controlling and generating\n  sound and music effects. Everything you need to add sound to games.\n- [fullScreen.js](https://github.com/kittykatattack/fullScreen): Adds an easy-to-implement full screen feature.\n- [Smoothie](https://github.com/kittykatattack/smoothie): Ultra-smooth sprite animation using \n  true delta-time interpolation. It also lets you specify the fps (frames-per-second) at which \n  your game or application runs, and completely separates your sprite rendering loop from your\n  application logic loop.\n\nThe job of `core.js` (this file!) is to instantiate Hexi, load the assets, start the game loop, and \ncreate top-level access to most of the properties and methods in the external libraries.\nIt also customizes some of those methods and runs them with some useful side-effects, such as \nautomatically adding sprites to Hexi's `stage`. (Hexi's `stage` is the root Pixi `Container` for the display list.)\n\nI've divided this `core.js` file into \"Chapters\" which describes what each major section of code does.\nYou'll find a \"Table of Contents\" ahead, which is your guide to this file.\nAll this code is fully commented, but if there's something you don't understand, please ask \nin this repository's Issues and we will do our best to help. All this code is in one single file for now, just for the sake of simplicity,\nuntil the total scope of this project stabilizes. \n\nHexi's build system\n-------------------\n\nAll of Hexi's source code is written in JavaScript ES6, transpiled to ES5 using Babel, and minified using Uglify2. \nMake is currently being used as the build\nsystem. So, to build Hexi, make sure you have Node, Babel and Uglify2 installed, and call `make` in the \ncommand line from Hexi's root directory. Make will compile the `core.js` file, concatenate all files (including\nthe modules) and produce the `hexi.min.js` file using Uglify2.\n\nYou can also use Make to build individual sections of Hexi's code base.\nIf you just want to watch and compile the core.js file from ES6 to ES5, run:\n\n   make watchSrc\n\nIf you want to concatenate all the modules, run:\n\n  make concatModules\n\nIf you want to concatenate all the files, run:\n\n  make concatAllFiles\n\nTo watch and compile the example files from ES6 to ES5, run:\n  \n  make watchExamples\n\nTo watch and compile the tutorial files from ES6 to ES5, run:\n\n  make watchTutorials\n\nIf anyone reading this wishes to contribute a simpler, more automated system using Grunt of Gulp, \nwe would welcome the contribution!\n\nTable of Contents\n-----------------\n\nHere's your handy guide to this `core.js` file.\n\n1. Setup and instantiation.\n2. The `Hexi` class constructor.\n3. Hexi's engine: `start`, `load` and `update` methods.\n4. Module interfaces: Hexi's top-level access to the module properties and methods.\n5. Sprite creation methods: `sprite`, `tilingSprite`, `text`, `bitmapText`, `rectangle`, `circle`, `line`, `button`.\n6. Display utilities: `group`, `batch`, `grid`, `makeTiledWorld`, `remove`, `flowRight`, `flowDown`, `flowLeft`, `flowUp`.\n7. Sprite properties: Hexi's custom sprite properties (also known as super-powers!).\n8. Utilities: `scaleToWindow`, `log`, `makeProgressBar`, `loadingBar`, `compensateForStageSize`, `image`, `id`, `json`, `xml`, `sound`\n\n*/\n\n\n//1. SETUP AND INSTANTIATION\n//---------------------------\n\n//IMPORTANT: Make sure to load Pixi and the modules before instantiating Hexi!\n\n//The high level `hexi` function lets you quickly create an instance\n//of Hexi using sensible defaults.\nfunction hexi(width, height, setup, thingsToLoad = undefined, load = undefined) {\n\n  //If you need to, you can also instantiate Hexi with a configuration\n  //object, which lets you fine-tune the options.\n  let hexi = new Hexi({\n\n    //Required options:\n    width: width, //Width, in pixels\n    height: height, //Height, in pixels\n    setup: setup, //Function to run when Hexi starts\n\n    //Optional options:\n    assets: thingsToLoad, //Array of assets that should be loaded\n    load: load, //Function to run while Hexi is loading asssets\n    /*\n    renderer: \"auto\",             //\"auto\", \"canvas\" or \"webgl\"\n    backgroundColor: 0xCCCCCC,    //Hexadecimal color code\n    border: \"1px dashed black\",   //CSS border string\n    scaleToWindow: true,          //Boolean\n    scaleBorderColor: \"gray\",     //Color string\n    fps: 30,                      //The frames per second the logic loop should run at\n\n    //An an object of Boolean (true/false) properties that describe which sprite\n    //properties should  be smoothly animated. These can be any of 5\n    //properties: `position`, `rotation`, `size`, `scale` or `alpha`.\n    //(Position and rotation are on by default, unless you set Hexi's\n    //`interpolate` property to `false`)\n    */\n    interpolationProperties: {\n      position: true,\n      rotation: true,\n      size: true,\n      alpha: true\n    },\n    interpolate: true,\n\n    //To change PIXI's renderer, set the `renderer` option to\n    //\"auto\", \"canvas\" or \"webgl\", like this:\n    //renderer: \"auto\"  \n    //Add any other Pixi initialization options you need, depending\n    //on which Pixi renderer you're using\n  });\n\n  return hexi;\n}\n\n//The Hexi main class. It contains all of Hexi's properties and\n//methods, and sets up bindings between Hexi and the module libraries.\n//If you need more find control over Hexi's initialization options,\n//you can create a new instance of the Hexi class directly in your application\n//code. See how it's done in the `hexi` function above for a good example\n//of how to do that.\n\n//2. THE HEXI CLASS CONSTRUCTOR\n//----------------------------\n\nclass Hexi {\n\n  /*\n  Initialize Hexi's constructor with an options object literal called `o`. \n  Here are the required options:\n\n  `width`: Value in pixels that describes the canvas's width\n  `height`: Value in pixels that describes the canvas's height\n  `setup`: A function that should run as soon as Hexi is initialized\n\n  Here are the optional options:\n\n  `assets`: Array of assets (files) that should be loaded\n  `load`: A function that should run while Hexi is loading assets\n  `renderer`: The type of renderer to use: \"auto\" (the default), \"canvas\" or \"webgl\"\n  `backgroundColor`: Hexadecimal color code that defines the canvas color\n  `border`: The canvas border style as a CSS border string, such as \"1px dashed black\"\n  `scaleToWindow`: A Boolean that determines whether the canvas should scale to maximum window size.\n  `scaleBorderColor`: Color string that defines the color of the border around a scaled canvas.\n  `interpolationProperties: An object that defines 5 Boolean properties that determines which sprite properties are interpolated \n                            (smoothly animated) by Hexi's rendering engine (Smoothie): `position`, `size`, `rotation`, `scale` or `alpha`\n  `interpolate`: A Boolean which should be `false` if you *don't* want any sprite animation smoothing.\n  `fps`: The frames-per-second the engine's game logic loop should run at (the default is 60).\n  `renderFps`: Clamps the fps rendering to the supplied frame rate.\n\n  You can also add any of Pixi's initialization options, and those will be applied \n  to Pixi's renderer when Hexi creates it.\n\n  */\n  constructor(o) {\n\n    //Initialize all the helper modules.\n    //(See Hexi's README.md on information about these libraries)\n    this.charm = new Charm(PIXI);\n    this.dust = new Dust(PIXI);\n    this.bump = new Bump(PIXI);\n    this.spriteUtilities = new SpriteUtilities(PIXI);\n    this.tileUtilities = new TileUtilities(PIXI);\n    this.gameUtilities = new GameUtilities();\n\n    //Any modules that have an `update` method that should updated\n    //each frame in the game loop should be added to the\n    //`modulesToUpdate` array. The game loop will call the `update`\n    //method on each of these modules while the game is running.\n    //This is very efficient and does not effect performance: no modules are updated unless they\n    //contain objects that need updating.\n    this.modulesToUpdate = [];\n    this.modulesToUpdate.push(this.charm);\n    this.modulesToUpdate.push(this.dust);\n    this.modulesToUpdate.push(this.spriteUtilities);\n\n    //Create the stage and renderer\n    //Auto renderer (default)\n    if (o.renderer === \"auto\" || o.renderer === undefined) {\n      this.renderer = PIXI.autoDetectRenderer(\n        o.width,\n        o.height,\n        o,\n        o.noWebGL\n      );\n\n      //Canvas renderer\n    } else if (o.renderer === \"canvas\") {\n      this.renderer = new PIXI.CanvasRenderer(\n        o.width,\n        o.height,\n        o\n      );\n\n      //WebGL renderer\n    } else if (o.renderer === \"webgl\") {\n      this.renderer = new PIXI.WebGLRenderer(\n        o.width,\n        o.height,\n        o\n      );\n    }\n\n    //Get a reference to the `renderer.view`, which is the\n    //HTML canvas element\n    this.canvas = this.renderer.view;\n\n    //Initialize the Tink interactive module (it needs a reference to the canvas)\n    this.tink = new Tink(PIXI, this.canvas);\n    this.modulesToUpdate.push(this.tink);\n\n    //Create local aliases for the important methods and properties of\n    //these libraries, including the most useful Pixi properties.\n    //Take a look at Hexi's `createModulePropertyAliases` method in the\n    //source code ahead to see how this works\n    this.createModulePropertyAliases();\n\n    //NOTE: MOVE TINK INITIALIZATION HERE AND INITIALIZE WITH THE CANVAS ELEMENT\n\n    //Add `halfWidth` and `halfHeight` properties to the canvas\n    Object.defineProperties.bind(this, this.canvas, {\n      \"halfWidth\": {\n        get() {\n          return this.canvas.width / 2\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"halfHeight\": {\n        get() {\n          return this.canvas.height / 2\n        },\n        enumerable: true,\n        configurable: true\n      }\n    });\n\n    //A Boolean to flag whether the canvas has been scaled\n    this.canvas.scaled = false;\n\n    //Add the FullScreen module and supply it with the canvas element\n    //this.fullScreen = new FullScreen(this.canvas);\n\n    //Note: Hexi's `update` function checks whether we're in full screen\n    //mode and updates the global scale value accordingly\n\n    //Set the canvas's optional background color and border style\n    if (o.backgroundColor) {\n      this.renderer.backgroundColor = this.color(o.backgroundColor);\n    } else {\n      this.renderer.backgroundColor = 0xFFFFFF;\n    }\n    if (o.border) this.canvas.style.border = o.border;\n\n    //Add the canvas to the HTML document\n    document.body.appendChild(this.canvas);\n\n    //Create a container object called the `stage`\n    this.stage = new this.Container();\n\n    //Add Hexi's special sprite properties to the stage\n    this.addProperties(this.stage);\n    this.stage._stage = true;\n\n    //The game's scale\n    if (o.scaleToWindow) {\n      this.scaleToWindow(o.scaleBorderColor);\n    } else {\n      this.scale = 1;\n    }\n\n    //Make the pointer\n    this.pointer = this.makePointer(this.canvas, this.scale);\n\n    //Set the game `state`\n    this.state = undefined;\n\n    //Set the user-defined `load` and `setup` states\n    if (o.load !== undefined) this.loadState = o.load;\n\n    //The `setup` function is required, so throw an error if it's\n    //missing\n    if (!o.setup) {\n      throw new Error(\n        \"Please supply the setup option in the constructor to tell Hexi which function should run first when it starts.\"\n      );\n    } else {\n      this.setupState = o.setup;\n    }\n\n    //A variable to track the current percentage of loading assets \n    this.loadingProgress = 0;\n\n    //A variable to track the currently loading asset\n    this.loadingFile = \"\";\n\n    //Load any assets if they've been provided\n    if (o.assets !== undefined) {\n      this.assetsToLoad = o.assets;\n    }\n\n    //Tell Hexi that we're not using a loading progress bar.\n    //(This will be set to `true` if the user invokes the `loadingBar`\n    //function, which you'll see ahead)\n    this._progressBarAdded = false;\n\n    //The `soundObjects` object is used to store all sounds\n    this.soundObjects = {};\n\n    //Create a new instance of Smoothie, which manages Hexi's game\n    //loop and adds smooth sprite interpolation\n    this.smoothie = new Smoothie({\n      engine: PIXI,\n      renderer: this.renderer,\n      root: this.stage,\n      update: this.update.bind(this),\n      properties: o.interpolationProperties,\n      interpolate: o.interpolate,\n      fps: o.fps,\n      renderFps: o.renderFps,\n      properties: {\n        position: true,\n        scale: true,\n        tile: true\n      }\n    });\n  }\n\n  //3. HEXI'S ENGINE: START, LOAD AND SETUP\n  //---------------------------------------\n\n  //The `start` method must be called by the user after Hexi has been\n  //initialized to start the loading process and turn on the engine.\n  start() {\n\n    //If there are assets to load, load them, and set the game's state\n    //to the user-defined `loadState` (which can be supplied by the user in the\n    //constructor)\n    if (this.assetsToLoad) {\n\n      //Call Hexi's `load` method (ahead) to load the assets\n      this.load(this.assetsToLoad, this.validateAssets);\n\n      //After the assets have been loaded, a method called\n      //`validateAssets` will run (see `validateAssets` ahead.)\n      //`validateAssets` checks to see what has been loaded and,\n      //in the case of sound files, decodes them and creates sound\n      //objects.\n\n      //If the user has supplied Hexi with a `load` function (in\n      //Hexi's constructor), it will be assigned to Hexi's current\n      //`state` and, as you'll see ahead, called in a loop while the\n      //assets load\n      if (this.loadState) this.state = this.loadState;\n    } else {\n\n      //If there's nothing to load, run the `setup` state, which will\n      //just run once\n      this.setupState();\n    }\n\n    //Start the game loop\n    this.smoothie.start();\n  }\n\n  //Use the `load` method to load any files into Hexi. Pass it a \n  //callback function as the second argument to launch a function that\n  //should run when all the assets have finished loading. Hexi's\n  //default callback function is `validateAssets`, which you'll find\n  //in the code ahead\n  load(assetsToLoad, callbackFunction = undefined) {\n\n    //Handle special file types that Pixi's loader doesn't understand\n    //The `findAssets` function will return an array to get an array just\n    //containing those file source paths you're interested in\n    let findAssets = fileExtensionArray => {\n      let fileSourcePaths = assetsToLoad.filter(source => {\n\n        //Find the file extension of the asset\n        let extension = source.split(\".\").pop();\n        if (fileExtensionArray.indexOf(extension) !== -1) {\n          return true;\n        }\n      });\n\n      return fileSourcePaths;\n    };\n\n    /* Load fonts */\n\n    //First, define the file extensions for the special file types\n    //you're interested in\n    //Fonts\n    let fontExtensions = [\"ttf\", \"otf\", \"ttc\", \"woff\"];\n\n    //Get the font source paths\n    let fontFiles = findAssets(fontExtensions);\n\n    //If there are any font files, load them into the browser using an\n    //old trick that forces the browser to load them\n    if (fontFiles.length > 0) {\n      this.spanElements = [];\n      fontFiles.forEach(source => {\n\n        //Loads the font files by writing CSS code to the HTML document head.\n        //Use the font's filename as the `fontFamily` name. This code captures \n        //the font file's name without the extension or file path\n        let fontFamily = source.split(\"/\").pop().split(\".\")[0];\n\n        //Push the font family name into Hexi's `fontFamilies` array\n        if (this.fontFamilies) this.fontFamilies.push(fontFamily);\n\n        //Append an `@afont-face` style rule to the head of the HTML document\n        let newStyle = document.createElement(\"style\");\n        let fontFace = \"@font-face {font-family: '\" + fontFamily + \"'; src: url('\" + source + \"');}\";\n        newStyle.appendChild(document.createTextNode(fontFace));\n        document.head.appendChild(newStyle);\n\n        //Trick the browser into loading the font file by \n        //displaying an invisible element\n        let span = document.createElement(\"span\");\n        span.style.fontFamily = fontFamily;\n        document.body.appendChild(span);\n        span.innerHTML = \"?\";\n        span.style.display = \"block\";\n        span.style.opacity = \"0\";\n        this.spanElements.push(span);\n      });\n    }\n\n    /* Load sound */\n\n    //Set default loading mechanism for sound file extensions to use XHR\n    let Resource = PIXI.loaders.Resource;\n    Resource.setExtensionLoadType(\"wav\", Resource.LOAD_TYPE.XHR);\n    Resource.setExtensionLoadType(\"mp3\", Resource.LOAD_TYPE.XHR);\n    Resource.setExtensionLoadType(\"ogg\", Resource.LOAD_TYPE.XHR);\n    Resource.setExtensionLoadType(\"webm\", Resource.LOAD_TYPE.XHR);\n\n    //Set default loading type for sound file extensions to be arraybuffer\n    Resource.setExtensionXhrType(\"wav\", Resource.XHR_RESPONSE_TYPE.BUFFER);\n    Resource.setExtensionXhrType(\"mp3\", Resource.XHR_RESPONSE_TYPE.BUFFER);\n    Resource.setExtensionXhrType(\"ogg\", Resource.XHR_RESPONSE_TYPE.BUFFER);\n    Resource.setExtensionXhrType(\"webm\", Resource.XHR_RESPONSE_TYPE.BUFFER);\n\n    /* Load ordinary assets */\n\n    let loadProgressHandler = (loader, resource) => {\n\n      //Display the file `url` currently being loaded\n      this.loadingFile = resource.url;\n\n      //Display the percentage of files currently loaded\n      this.loadingProgress = loader.progress;\n    };\n\n    //Load the files and call the `loadProgressHandler` while they're\n    //loading\n    this.loader.reset();\n    this.loadingProgress = 0;\n    this.loadingFile = \"\";\n    this.loader\n      .add(assetsToLoad)\n      .on(\"progress\", loadProgressHandler)\n      .load(callbackFunction.bind(this));\n  }\n\n  //The `validateAssets` method runs when all the assets have finished\n  //loading. It checks to see if there are any sounds files and, if\n  //there are, decodes them and turns them into sound objects using the \n  //`sounds.js` module's `makeSound` function. If there are no sounds\n  //to load, the loading state is finished and the setup state is run.\n  //But, if there are sounds to load, the setup state will only run\n  //after the sounds have been decoded.\n  validateAssets() {\n    console.log(\"All assets loaded\");\n\n    //The `finishLoadingState` method will be called if everything has\n    //finished loading and any possible sounds have been decoded\n    let finishLoadingState = () => {\n\n      //Reset the `assetsToLoad` array\n      this.assetsToLoad = [];\n\n      //Clear the `loadState`\n      this.loadState = undefined;\n\n      //Clear the game `state` function for now to stop the loop.\n      this.state = undefined;\n\n      //Remove the loading progress bar if the user invoked the `loadingBar`\n      //function\n      if (this._progressBarAdded) {\n        this.progressBar.remove();\n      }\n\n      //If any fonts were tricked into loading \n      //make the <span> tags that use them invisible\n      if (this.spanElements) {\n        this.spanElements.forEach(element => {\n          element.style.display = \"none\";\n        });\n      }\n\n      //Call the `setup` state\n      this.setupState();\n    };\n\n    //We need to check if any possible sound file have been loaded\n    //because, if there have, they need to fist be decoded before we\n    //can launch the `setup` state.\n\n    //Variables to count the number of sound files and the sound files\n    //that have been decoded. If both these numbers are the same at\n    //some point, then we know all the sounds have been decoded and we\n    //can call the `finishLoadingState` function\n    let soundsToDecode = 0,\n      soundsDecoded = 0;\n\n    //First, create a list of the kind of sound files we want to check\n    let soundExtensions = [\"wav\", \"mp3\", \"ogg\", \"webm\"];\n\n    //The `decodeHandler` will run when each sound file is decoded\n    let decodeHandler = () => {\n\n      //Count 1 more sound as having been decoded\n      soundsDecoded += 1;\n\n      //If the decoded sounds match the number of sounds to decode,\n      //then we know all the sounds have been decoded and we can call\n      //`finishLoadingState`\n      if (soundsToDecode === soundsDecoded) {\n        finishLoadingState();\n      }\n    };\n\n    //Loop through all the loader's resources and look for sound files\n    Object.keys(this.loader.resources).forEach(resource => {\n\n      //Find the file extension of the asset\n      let extension = resource.split(\".\").pop();\n\n      //If one of the resource file extensions matches the sound file\n      //extensions, then we know we have a sound file\n      if (soundExtensions.indexOf(extension) !== -1) {\n\n        //Count one more sound to load\n        soundsToDecode += 1;\n\n        //Create aliases for the sound's `xhr` object and `url` (its\n        //file name)\n        let xhr = this.loader.resources[resource].xhr,\n          url = this.loader.resources[resource].url;\n\n        //Create a sound sprite using the `sound.js` module's\n        //`makeSound` function. Notice the 4th argument is the loaded\n        //sound's `xhr` object. Setting the 3rd argument to `false`\n        //means that `makeSound` won't attempt to load the sounds\n        //again. When the sound has been decoded, the `decodeHandler`\n        //(see above!) will be run\n        let soundSprite = makeSound(url, decodeHandler.bind(this), false, xhr);\n\n        //Get the sound file name.\n        soundSprite.name = this.loader.resources[resource].name;\n\n        //Add the sound object to Hexi's `soundObjects` object.\n        //You'll be able to access them in your application through\n        //Hexi's higher-level `sound` method, like this:\n        //`hexi.sound(\"soundFileName.wav\");`\n        this.soundObjects[soundSprite.name] = soundSprite;\n      }\n    });\n\n    //If there are no sound files, we can skip the decoding step and\n    //just call `finishLoadingState` directly\n    if (soundsToDecode === 0) {\n      finishLoadingState();\n    }\n  }\n\n  //The `update` method is run by Hexi's game loop each frame.\n  //It manages the game state and updates the modules\n  update() {\n\n    //Update all the modules in the `modulesToUpdate` array.\n    //These are modules that contain `update` methods that need to be\n    //called every frame\n    this.modulesToUpdate.forEach(module => module.update());\n    //If the application is in full screen mode, make sure that Hexi\n    //is using the correct scale value\n    /*\n    if (document.fullscreenEnabled === true) {\n      console.log(\"fullscreenEnabled\")\n\n      //Note: Check Firefox's current FullScreen API and specifically:\n      //https://github.com/neovov/Fullscreen-API-Polyfill/blob/master/fullscreen-api-polyfill.js  \n      //if (this.fullScreen.fullscreenScale !== 1) {\n      this.scale = this.fullScreen.fullscreenScale;\n      //console.log(\"this.fullScreen.fullscreenScale: \" + this.fullScreen.fullscreenScale)\n      this.pointer.scale = this.scale;\n      //Find out if the pointer scale is propagating to Tink's pointer?\n      console.log(this.pointer.scale)\n    } else {\n      if (!this.canvas.scaled) {\n        this.scale = 1;\n        this.pointer.scale = 1;\n      }\n    }\n    */\n\n    //Run the current game `state` function if it's been defined and\n    //the game isn't `paused`\n    if (this.state && !this.paused) {\n      this.state();\n    }\n  }\n\n  //Pause and resume methods\n  pause() {\n    this.paused = true;\n  }\n  resume() {\n    this.paused = false;\n  }\n\n  //4. MODULE INTERFACES\n\n  //A method that helpfully creates local, top-level references to the\n  //most useful properties and methods from the loaded modules\n  createModulePropertyAliases() {\n\n    //Pixi - Rendering\n    this.Container = PIXI.Container;\n    this.loader = PIXI.loader;\n    this.TextureCache = PIXI.utils.TextureCache;\n    this.filters = PIXI.filters;\n    //Filters\n    this.dropShadowFilter = () => new this.filters.DropShadowFilter();\n    this.asciiFilter = () => new this.filters.AsciiFilter();\n    this.alphaMaskFilter = () => new this.filters.AlphaMaskFilter();\n    this.bloomFilter = () => new this.filters.BloomFilter();\n    this.blurDirFilter = () => new this.filters.BlurDirFilter();\n    this.blurFilter = () => new this.filters.BlurFilter();\n    this.colorMatrixFilter = () => new this.filters.ColorMatrixFilter();\n    this.colorStepFilter = () => new this.filters.ColorStepFilter();\n    this.crossHatchFilter = () => new this.filters.CrossHatchFilter();\n    this.displacementFilter = () => new this.filters.DisplacementFilter();\n    this.dotScreenFilter = () => new this.filters.DotScreenFilter();\n    this.grayFilter = () => new this.filters.GrayFilter();\n    this.invertFilter = () => new this.filters.InvertFilter();\n    this.pixelateFilter = () => new this.filters.PixelateFilter();\n    this.sepiaFilter = () => new this.filters.SepiaFilter();\n    this.shockwaveFilter = () => new this.filters.ShockwaveFilter();\n    this.twistFilter = () => new this.filters.TwistFilter();\n    this.rgbSplitFilter = () => new this.filters.RGBSplitFilter();\n    this.smartBlurFilter = () => new this.filters.SmartBlurFilter();\n    this.tiltShiftFilter = () => new this.filters.TiltShiftFilter();\n\n    //Tink - Interactivity\n    this.draggableSprites = this.tink.draggableSprites;\n    this.pointers = this.tink.pointers;\n    this.buttons = this.tink.buttons;\n    this.makePointer = (canvas, scale) => this.tink.makePointer(canvas, scale);\n    this.makeDraggable = (...sprites) => this.tink.makeDraggable(...sprites);\n    this.makeUndraggable = (...sprites) => this.tink.makeUndraggable(...sprites);\n    this.makeInteractive = (o) => this.tink.makeInteractive(o);\n    this.keyboard = this.tink.keyboard;\n    this.arrowControl = (sprite, speed) => this.tink.arrowControl(sprite, speed);\n\n    //Add the arrow key objects\n    /*\n    this.upArrow = this.keyboard(38);\n    this.rightArrow = this.keyboard(39);\n    this.downArrow = this.keyboard(40);\n    this.leftArrow = this.keyboard(37);\n    this.spaceBar = this.keyboard(32);\n    */\n\n    //Dust - Particle effects\n    this.createParticles = (\n      x, y, spriteFunction, container, numberOfParticles, gravity, randomSpacing, minAngle, maxAngle, minSize, maxSize,\n      minSpeed, maxSpeed, minScaleSpeed, maxScaleSpeed, minAlphaSpeed, maxAlphaSpeed, minRotationSpeed, maxRotationSpeed\n    ) => this.dust.create(\n      x, y, spriteFunction, container, numberOfParticles, gravity, randomSpacing, minAngle, maxAngle, minSize, maxSize,\n      minSpeed, maxSpeed, minScaleSpeed, maxScaleSpeed, minAlphaSpeed, maxAlphaSpeed, minRotationSpeed, maxRotationSpeed\n    );\n    this.particleEmitter = (interval, particleFunction) => this.dust.emitter(interval, particleFunction);\n\n    //SpriteUtilities - Sprite creation tools\n    this.filmstrip = (texture, frameWidth, frameHeight, spacing) => this.spriteUtilities.filmstrip(texture, frameWidth, frameHeight, spacing);\n    this.frame = (source, x, y, width, height) => this.spriteUtilities.frame(source, x, y, width, height);\n    this.frames = (source, coordinates, frameWidth, frameHeight) => this.spriteUtilities.frames(source, coordinates, frameWidth, frameHeight);\n    this.frameSeries = (startNumber, endNumber, baseName, extension) => this.spriteUtilities.frames(startNumber, endNumber, baseName, extension);\n    this.colorToRGBA = value => this.spriteUtilities.colorToRGBA(value);\n    this.colorToHex = value => this.spriteUtilities.colorToHex(value);\n    this.byteToHex = value => this.spriteUtilities.byteToHex(value);\n    this.color = value => this.spriteUtilities.color(value);\n    this.shoot = (shooter, angle, x, y, container, bulletSpeed, bulletArray, bulletSprite) => {\n      return this.spriteUtilities.shoot(shooter, angle, x, y, container, bulletSpeed, bulletArray, bulletSprite)\n    };\n    this.shake = (sprite, magnitude = 16, angular = false) => {\n      console.log(\"shake\")\n      return this.spriteUtilities.shake(sprite, magnitude, angular);\n    }\n\n    //Charm - Tweening\n    this.fadeOut = (sprite, frames = 60) => this.charm.fadeOut(sprite, frames);\n    this.fadeIn = (sprite, frames = 60) => this.charm.fadeIn(sprite, frames);\n    this.pulse = (sprite, frames = 60, minAlpha = 0) => this.charm.pulse(sprite, frames, minAlpha);\n    this.slide = (sprite, endX, endY, frames = 60, type = \"smoothstep\", yoyo = false, delayBeforeRepeat = 0) => {\n      return this.charm.slide(sprite, endX, endY, frames, type, yoyo, delayBeforeRepeat = 0);\n    };\n    this.breathe = (sprite, endScaleX = 0.8, endScaleY = 0.8, frames = 60, yoyo = true, delayBeforeRepeat = 0) => {\n      return this.charm.breathe(sprite, endScaleX, endScaleY, frames, yoyo, delayBeforeRepeat);\n    };\n    this.scale = (sprite, endScaleX = 0.5, endScaleY = 0.5, frames = 60) => this.charm.scale(sprite, endScaleX, endScaleY, frames);\n    this.strobe = (sprite, scaleFactor = 1.3, startMagnitude = 10, endMagnitude = 20, frames = 10, yoyo = true, delayBeforeRepeat = 0) => {\n      return this.charm.strobe(sprite, scaleFactor, startMagnitude, endMagnitude, frames, yoyo, delayBeforeRepeat);\n    };\n    this.wobble = (\n      sprite, scaleFactorX = 1.2, scaleFactorY = 1.2, frames = 10, xStartMagnitude = 10, xEndMagnitude = 10,\n      yStartMagnitude = -10, yEndMagnitude = -10, friction = 0.98, yoyo = true, delayBeforeRepeat = 0\n    ) => {\n      return this.charm.wobble(\n        sprite, scaleFactorX = 1.2, scaleFactorY = 1.2, frames = 10, xStartMagnitude = 10, xEndMagnitude = 10,\n        yStartMagnitude = -10, yEndMagnitude = -10, friction = 0.98, yoyo = true, delayBeforeRepeat = 0\n      );\n    };\n    this.followCurve = (sprite, pointsArray, totalFrames, type = \"smoothstep\", yoyo = false, delayBeforeRepeat = 0) => {\n      return this.charm.followCurve(sprite, pointsArray, totalFrames, type, yoyo, delayBeforeRepeat);\n    };\n    this.walkPath = (sprite, originalPathArray, totalFrames = 300, type = \"smoothstep\", loop = false, yoyo = false, delayBetweenSections = 0) => {\n      return this.charm.walkPath(sprite, originalPathArray, totalFrames, type, loop, yoyo, delayBetweenSections);\n    };\n    this.walkCurve = (sprite, pathArray, totalFrames = 300, type = \"smoothstep\", loop = false, yoyo = false, delayBeforeContinue = 0) => {\n      return this.charm.walkCurve(sprite, pathArray, totalFrames, type, loop, yoyo, delayBeforeContinue);\n    };\n    this.removeTween = (tweenObject) => this.charm.removeTween(tweenObject);\n    this.makeTween = (tweensToAdd) => this.charm.makeTween(tweensToAdd);\n    this.tweenProperty = (sprite, property, startValue, endValue, totalFrames, type = \"smoothstep\", yoyo = false, delayBeforeRepeat = 0) => {\n      return this.charm.tweenProperty(sprite, property, startValue, endValue, totalFrames, type, yoyo, delayBeforeRepeat);\n    };\n\n    //Bump - Collision\n    this.hitTestPoint = (point, sprite) => this.bump.hitTestPoint(point, sprite);\n    this.hitTestCircle = (c1, c2, global = false) => this.bump.hitTestCircle(c1, c2, global);\n    this.circleCollision = (c1, c2, bounce = false, global = false) => this.bump.circleCollision(c1, c2, bounce, global);\n    this.movingCircleCollision = (c1, c2, global = false) => this.bump.movingCircleCollision(c1, c2, global);\n    this.multipleCircleCollision = (arrayOfCircles, global = false) => this.bump.multipleCircleCollision(arrayOfCircles, global);\n    this.rectangleCollision = (r1, r2, bounce = false, global = true) => this.bump.rectangleCollision(r1, r2, bounce, global);\n    this.hitTestRectangle = (r1, r2, global = false) => this.bump.hitTestRectangle(r1, r2, global);\n    this.hitTestCircleRectangle = (c1, r1, global = false) => this.bump.hitTestCircleRectangle(c1, r1, global);\n    this.hitTestCirclePoint = (c1, point, global = false) => this.bump.hitTestCirclePoint(c1, point, global);\n    this.circleRectangleCollision = (c1, r1, bounce = false, global = false) => this.bump.circleRectangleCollision(c1, r1, bounce, global);\n    this.circlePointCollision = (c1, point, bounce = false, global = false) => this.bump.circlePointCollision(c1, point, bounce, global);\n    this.bounceOffSurface = (o, s) => this.bump.bounceOffSurface(o, s);\n    this.hit = (a, b, react = false, bounce = false, global, extra = undefined) => this.bump.hit(a, b, react, bounce, global, extra);\n\n    //Intercept the Bump library's `contain` and `outsideBounds` methods to make sure that\n    //the stage `width` and `height` match the canvas width and height\n    this.contain = (sprite, container, bounce = false, extra = undefined) => {\n      let o = {};\n      if (container._stage) {\n        o = this.compensateForStageSize(container);\n      } else {\n        o = container\n      }\n      return this.bump.contain(sprite, o, bounce, extra);\n    };\n\n    this.outsideBounds = (sprite, container, extra = undefined) => {\n      let o = {};\n      if (container._stage) {\n        o = this.compensateForStageSize(container);\n      } else {\n        o = container\n      }\n      return this.bump.outsideBounds(sprite, o, extra);\n    };\n\n    //GameUtilities - Useful utilities\n    this.distance = (s1, s2) => this.gameUtilities.distance(s1, s2);\n    this.followEase = (follower, leader, speed) => this.gameUtilities.followEase(follower, leader, speed);\n    this.followConstant = (follower, leader, speed) => this.gameUtilities.followConstant(follower, leader, speed);\n    this.angle = (s1, s2) => this.gameUtilities.angle(s1, s2);\n    this.rotateAroundSprite = (rotatingSprite, centerSprite, distance, angle) => this.gameUtilities.rotateAroundSprite(rotatingSprite, centerSprite, distance, angle);\n    this.rotateAroundPoint = this.gameUtilities.rotateAroundPoint;\n    this.randomInt = this.gameUtilities.randomInt;\n    this.randomFloat = this.gameUtilities.randomFloat;\n    this.move = this.gameUtilities.move;\n    this.wait = this.gameUtilities.wait;\n    this.worldCamera = (world, worldWidth, worldHeight, canvas = this.canvas) => this.gameUtilities.worldCamera(world, worldWidth, worldHeight, canvas);\n\n    //Sound.js - Sound\n    this.soundEffect = (\n      frequencyValue, attack, decay, type, volumeValue, panValue, wait, pitchBendAmount, reverse,\n      randomValue, dissonance, echo, reverb\n    ) => {\n      return soundEffect(\n        frequencyValue, attack, decay, type, volumeValue, panValue, wait, pitchBendAmount, reverse,\n        randomValue, dissonance, echo, reverb\n      );\n    };\n\n    //FullScreen\n    //this.enableFullScreen = (exitKeyCodes) => this.fullScreen.enableFullScreen(exitKeyCodes);\n\n    //TileUtilities\n    this.hitTestTile = (sprite, mapArray, gidToCheck, world, pointsToCheck) => {\n      return this.tileUtilities.hitTestTile(sprite, mapArray, gidToCheck, world, pointsToCheck);\n    };\n    this.getIndex = (x, y, tilewidth, tileheight, mapWidthInTiles) => {\n      return this.tileUtilities.getIndex(x, y, tilewidth, tileheight, mapWidthInTiles);\n    };\n    this.getTile = this.tileUtilities.getTile;\n    this.surroundingCells = this.tileUtilities.surroundingCells;\n    this.getPoints = this.tileUtilities.getPoints;\n    this.updateMap = (mapArray, spritesToUpdate, world) => {\n      return this.tileUtilities.updateMap(mapArray, spritesToUpdate, world);\n    };\n    this.byDepth = this.tileUtilities.byDepth;\n    this.hitTestIsoTile = (sprite, mapArray, gidToCheck, world, pointsToCheck) => {\n      return this.tileUtilities.hitTestIsoTile(sprite, mapArray, gidToCheck, world, pointsToCheck);\n    };\n    this.getIsoPoints = this.tileUtilities.getIsoPoints;\n    this.makeIsoPointer = (pointer, world) => {\n      return this.tileUtilities.makeIsoPointer(pointer, world);\n    };\n    this.isoRectangle = (width, height, fillStyle) => {\n      return this.tileUtilities.isoRectangle(width, height, fillStyle);\n    };\n    this.addIsoProperties = (sprite, x, y, width, height) => {\n      return this.tileUtilities.addIsoProperties(sprite, x, y, width, height);\n    };\n    this.makeIsoTiledWorld = (jsonTiledMap, tileset) => {\n      return this.tileUtilities.makeIsoTiledWorld(jsonTiledMap, tileset);\n    };\n\n  }\n\n  //Getters and setters\n\n  //Pixi's loader resources\n  get resources() {\n    return this.loader.resources\n  }\n\n  //Add Smoothie getters and setters to access the `fps`,\n  //`properties`, `renderFps` and `interpolate` properties\n  get fps() {\n    return this.smoothie.fps;\n  }\n  set fps(value) {\n    this.smoothie.fps = value;\n  }\n\n  get renderFps() {\n    return this.smoothie.renderFps;\n  }\n  set renderFps(value) {\n    this.smoothie.renderFps = value;\n  }\n\n  get interpolate() {\n    return this.smoothie.interpolate;\n  }\n  set interpolate(value) {\n    this.smoothie.interpolate = value;\n  }\n\n  get interpolationProperties() {\n    return this.smoothie.properties;\n  }\n  set interpolationProperties(value) {\n    this.smoothie.properties = value;\n  }\n\n  //The `border` property lets you set the border style on the canvas\n  set border(value) {\n    this.canvas.style.border = value;\n  }\n\n  //The `backgroundColor` property lets you set the background color\n  //of the renderer\n  set backgroundColor(value) {\n    this.renderer.backgroundColor = this.color(value);\n  }\n\n\n  //5. SPRITE CREATION METHODS\n\n  //Hexi uses methods from the\n  //SpriteUtilities module to help create sprites. But, as a helpful bonus, Hexi automatically adds sprites \n  //to the `stage` container. (The `stage` is Hexi's root container for all\n  //Hexi sprites.) Hexi also adds a whole bunch of\n  //extra, useful properties and methods to sprites with the\n  //`addProperties` method\n\n  //Universal sprites\n  sprite(source, x = 0, y = 0, tiling = false, width, height) {\n    let o = this.spriteUtilities.sprite(source, x, y, tiling, width, height);\n    this.addProperties(o);\n    this.stage.addChild(o);\n    return o;\n  }\n\n  //Tiling sprites\n  tilingSprite(source, width, height, x = 0, y = 0) {\n    let o = this.spriteUtilities.tilingSprite(source, width, height, x, y);\n    this.addProperties(o);\n    this.stage.addChild(o);\n    return o;\n  }\n\n  //Hexi's `text` method is a quick way to create a Pixi Text sprite\n  //and add it to the stage\n  text(content = \"message\", font = \"16px sans\", fillStyle = \"red\", x = 0, y = 0) {\n    let message = this.spriteUtilities.text(content, font, fillStyle, x, y);\n    this.addProperties(message);\n    this.stage.addChild(message);\n    return message;\n  }\n\n  //The `bitmapText` method is a quick way to create a Pixi BitmapText sprite\n  bitmapText(content = \"message\", font, align, tint, x = 0, y = 0) {\n    let message = this.spriteUtilities.bitmapText(content, font, align, tint, x, y);\n    this.addProperties(message);\n    this.stage.addChild(message);\n    return message;\n  }\n\n  //Make a rectangle and add it to the stage\n  rectangle(width = 32, height = 32, fillStyle = 0xFF3300, strokeStyle = 0x0033CC, lineWidth = 0, x = 0, y = 0) {\n    let o = this.spriteUtilities.rectangle(width, height, fillStyle, strokeStyle, lineWidth, x, y);\n    this.addProperties(o);\n    this.stage.addChild(o);\n    return o;\n  }\n\n  //Make a circle and add it to the stage\n  circle(diameter = 32, fillStyle = 0xFF3300, strokeStyle = 0x0033CC, lineWidth = 0, x = 0, y = 0) {\n    let o = this.spriteUtilities.circle(diameter, fillStyle, strokeStyle, lineWidth, x, y);\n    this.addProperties(o);\n\n    //Add diameter and radius properties to the circle\n    o.circular = true;\n    this.stage.addChild(o);\n    return o;\n  }\n\n  //Draw a line\n  line(strokeStyle = 0x000000, lineWidth = 1, ax = 0, ay = 0, bx = 32, by = 32) {\n    let o = this.spriteUtilities.line(strokeStyle, lineWidth, ax, ay, bx, by);\n    this.addProperties(o);\n    this.stage.addChild(o);\n    return o;\n  }\n\n  //Make a button and add it to the stage\n  button(source, x, y) {\n    let o = this.tink.button(source, x, y);\n    this.addProperties(o);\n    this.stage.addChild(o);\n    return o;\n  }\n\n  //6. DISPLAY UTILITIES\n  //--------------------\n\n  //Use `group` to create a Container\n  group(...sprites) {\n    let o = this.spriteUtilities.group(...sprites);\n    this.addProperties(o);\n    this.stage.addChild(o);\n    return o;\n  }\n\n  //`batch` creates a Pixi ParticleContainer\n  batch(size, options) {\n    let o = this.spriteUtilities.batch(size, options);\n    this.addProperties(o);\n    this.stage.addChild(o);\n    return o;\n  }\n\n  //Create a grid of sprite\n  grid(\n    columns = 0, rows = 0, cellWidth = 32, cellHeight = 32,\n    centerCell = false, xOffset = 0, yOffset = 0,\n    makeSprite = undefined,\n    extra = undefined\n  ) {\n\n    let o = this.spriteUtilities.grid(\n      columns, rows, cellWidth, cellHeight,\n      centerCell, xOffset, yOffset, makeSprite, extra\n    );\n    this.addProperties(o);\n    this.stage.addChild(o);\n    return o;\n  }\n\n  //`makeTiledWorld` uses a Tiled Editor JSON file to generate a game\n  //world. It uses the `makeTiledWorld` method from the\n  //`tileUtilities` module to do help do this.\n  makeTiledWorld(jsonTiledMap, tileset) {\n    let o = this.tileUtilities.makeTiledWorld(jsonTiledMap, tileset);\n    this.addProperties(o);\n\n    //Add Hexi's special sprite properties to the world object and all\n    //its child objects\n    let addHexiSpriteProperties = object => {\n      this.addProperties(object);\n      if (object.children) {\n        if (object.children.length > 0) {\n          object.children.forEach(child => {\n            addHexiSpriteProperties(child);\n          });\n        }\n      }\n    };\n    if (o.children) {\n      if (o.children.length > 0) {\n        o.children.forEach(child => {\n          addHexiSpriteProperties(child);\n        });\n      }\n    }\n\n    //Return the world object\n    this.stage.addChild(o);\n    return o;\n  }\n\n  //Use `remove` to remove a sprite from its parent. You can supply a \n  //single sprite, a list of sprites, or an array of sprites \n  remove(...sprites) {\n    this.spriteUtilities.remove(...sprites);\n  }\n\n  //The flow methods: `flowRight`, `flowDown`, `flowLeft` and\n  //`flowUp`.\n  //Use them to easily align a row of sprites horizontally or\n  //vertically. The flow methods take two arguments: the padding (in\n  //pixels) between the sprites, and list of sprites (or an array\n  //containing sprites) that you want to align.\n  //(This feature was inspired by the Elm programming language)\n\n  //flowRight\n  flowRight(padding, ...sprites) {\n\n    //A function to flow the sprites\n    let flowSprites = (spritesToFlow) => {\n      if (spritesToFlow.length > 0) {\n        for (let i = 0; i < spritesToFlow.length - 1; i++) {\n          let sprite = spritesToFlow[i];\n          sprite.putRight(spritesToFlow[i + 1], +padding);\n        }\n      }\n    };\n\n    //Check if `sprites` is a an array of sprites, or an \n    //array containing sprite objects\n    if (!(sprites[0] instanceof Array)) {\n\n      //It's an array of sprites\n      flowSprites(sprites);\n    } else {\n\n      //It's an array containing sprite objects\n      let spritesArray = sprites[0];\n      flowSprites(spritesArray);\n    }\n  }\n\n  //flowDown\n  flowDown(padding, ...sprites) {\n    let flowSprites = (spritesToFlow) => {\n      if (spritesToFlow.length > 0) {\n        for (let i = 0; i < spritesToFlow.length - 1; i++) {\n          let sprite = spritesToFlow[i];\n          sprite.putBottom(spritesToFlow[i + 1], 0, +padding);\n        }\n      }\n    };\n    if (!(sprites[0] instanceof Array)) {\n      flowSprites(sprites);\n    } else {\n      let spritesArray = sprites[0];\n      flowSprites(spritesArray);\n    }\n  }\n\n  //flowLeft\n  flowLeft(padding, ...sprites) {\n    let flowSprites = (spritesToFlow) => {\n      if (spritesToFlow.length > 0) {\n        for (let i = 0; i < spritesToFlow.length - 1; i++) {\n          let sprite = spritesToFlow[i];\n          sprite.putLeft(spritesToFlow[i + 1], -padding);\n        }\n      }\n    };\n    if (!(sprites[0] instanceof Array)) {\n      flowSprites(sprites);\n    } else {\n      let spritesArray = sprites[0];\n      flowSprites(spritesArray);\n    }\n  }\n\n  //flowUp\n  flowUp(padding, ...sprites) {\n    let flowSprites = (spritesToFlow) => {\n      if (spritesToFlow.length > 0) {\n        for (let i = 0; i < spritesToFlow.length - 1; i++) {\n          let sprite = spritesToFlow[i];\n          sprite.putTop(spritesToFlow[i + 1], 0, -padding);\n        }\n      }\n    };\n    if (!(sprites[0] instanceof Array)) {\n      flowSprites(sprites);\n    } else {\n      let spritesArray = sprites[0];\n      flowSprites(spritesArray);\n    }\n  }\n\n  //7. SPRITE PROPERTIES\n\n  //The sprite creation methods above all run the `addProperties`\n  //method on each sprite they create. `addProperties` adds special\n  //properties and methods (super powers!) to Hexi sprites.\n\n  addProperties(o) {\n\n    //Velocity\n    o.vx = 0;\n    o.vy = 0;\n\n    //A \"private\" `_layer` property\n    o._layer = 0;\n\n    //Is the sprite circular? If it is, it will be given a `radius`\n    //and `diameter`\n    o._circular = false;\n\n    //Is the sprite interactive? Setting this to `true` makes the\n    //sprite behave like a button\n    o._interact = false;\n\n    //Is the sprite draggable?\n    o._draggable = false;\n\n    //Flag this object for compatibility with the Bump collision\n    //library\n    o._bumpPropertiesAdded = true;\n\n    //Swap the depth layer positions of two child sprites\n    o.swapChildren = (child1, child2) => {\n      let index1 = o.children.indexOf(child1),\n        index2 = o.children.indexOf(child2);\n      if (index1 !== -1 && index2 !== -1) {\n\n        //Swap the indexes\n        child1.childIndex = index2;\n        child2.childIndex = index1;\n\n        //Swap the array positions\n        o.children[index1] = child2;\n        o.children[index2] = child1;\n      } else {\n        throw new Error(child + \" Both objects must be a child of the caller \" + o);\n      }\n    };\n\n    //`add` and `remove` convenience methods let you add and remove\n    //many sprites at the same time.\n    o.add = (...sprites) => {\n      if (sprites.length > 1) {\n        sprites.forEach(sprite => o.addChild(sprite));\n      } else {\n        o.addChild(sprites[0]);\n      }\n    };\n    o.remove = (...sprites) => {\n      if (sprites.length > 1) {\n        sprites.forEach(sprite => o.removeChild(sprite));\n      } else {\n        o.removeChild(sprites[0]);\n      }\n    };\n\n    //The `put` methods are conveniences that help you position a\n    //another sprite in and around this sprite.\n    //First, get a short form reference to the sprite to make the code\n    //easier to read\n    let a = o;\n\n    //The `nudgeAnchor`, `compensateForAnchor` and\n    //`compensateForAnchors` (with an \"s\"!) methods are used by\n    //the `put` methods to adjust the position of the sprite based on\n    //its x/y anchor point.\n    let nudgeAnchor = (o, value, axis) => {\n      if (o.anchor !== undefined) {\n        if (o.anchor[axis] !== 0) {\n          return value * ((1 - o.anchor[axis]) - o.anchor[axis]);\n        } else {\n          return value;\n        }\n      } else {\n        return value;\n      }\n    };\n\n    let compensateForAnchor = (o, value, axis) => {\n      if (o.anchor !== undefined) {\n        if (o.anchor[axis] !== 0) {\n          return value * o.anchor[axis];\n        } else {\n          return 0;\n        }\n      } else {\n        return 0;\n      }\n    };\n\n    let compensateForAnchors = (a, b, property1, property2) => {\n      return compensateForAnchor(a, a[property1], property2) + compensateForAnchor(b, b[property1], property2)\n    };\n\n    //The `put` methods:\n    //Center a sprite inside this sprite. `xOffset` and `yOffset`\n    //arguments determine by how much the other sprite's position\n    //should be offset from the center. These methods use the\n    //sprites' global coordinates (`gx` and `gy`).\n    //In all these functions, `b` is the second sprite that is being\n    //positioned relative to the first sprite (this one), `a`.\n    //Center `b` inside `a`.\n    o.putCenter = (b, xOffset = 0, yOffset = 0) => {\n      if (o._stage) a = this.compensateForStageSize(o);\n      //b.x = (a.x + a.halfWidth - (b.halfWidth * ((1 - b.anchor.x) - b.anchor.x))) + xOffset;\n      b.x = (a.x + nudgeAnchor(a, a.halfWidth, \"x\") - nudgeAnchor(b, b.halfWidth, \"x\")) + xOffset;\n      b.y = (a.y + nudgeAnchor(a, a.halfHeight, \"y\") - nudgeAnchor(b, b.halfHeight, \"y\")) + yOffset;\n\n      //Compensate for the parent's position\n      if (!o._stage) o.compensateForParentPosition(a, b);\n    };\n\n    //Position `b` to the left of `a`.\n    o.putLeft = (b, xOffset = 0, yOffset = 0) => {\n      if (o._stage) a = this.compensateForStageSize(o);\n      b.x = (a.x - nudgeAnchor(b, b.width, \"x\")) + xOffset - compensateForAnchors(a, b, \"width\", \"x\");\n      b.y = (a.y + nudgeAnchor(a, a.halfHeight, \"y\") - nudgeAnchor(b, b.halfHeight, \"y\")) + yOffset;\n\n      //Compensate for the parent's position\n      if (!o._stage) o.compensateForParentPosition(a, b);\n    };\n\n    //Position `b` above `a`.\n    o.putTop = (b, xOffset = 0, yOffset = 0) => {\n      if (o._stage) a = this.compensateForStageSize(o);\n      b.x = (a.x + nudgeAnchor(a, a.halfWidth, \"x\") - nudgeAnchor(b, b.halfWidth, \"x\")) + xOffset;\n      b.y = (a.y - nudgeAnchor(b, b.height, \"y\")) + yOffset - compensateForAnchors(a, b, \"height\", \"y\");\n\n      //Compensate for the parent's position\n      if (!o._stage) o.compensateForParentPosition(a, b);\n    };\n\n    //Position `b` to the right of `a`.\n    o.putRight = (b, xOffset = 0, yOffset = 0) => {\n      if (o._stage) a = this.compensateForStageSize(o);\n      b.x = (a.x + nudgeAnchor(a, a.width, \"x\")) + xOffset + compensateForAnchors(a, b, \"width\", \"x\");\n      b.y = (a.y + nudgeAnchor(a, a.halfHeight, \"y\") - nudgeAnchor(b, b.halfHeight, \"y\")) + yOffset;\n      //b.x = (a.x + a.width) + xOffset;\n      //b.y = (a.y + a.halfHeight - b.halfHeight) + yOffset;\n\n      //Compensate for the parent's position\n      if (!o._stage) o.compensateForParentPosition(a, b);\n    };\n\n    //Position `b` below `a`.\n    o.putBottom = (b, xOffset = 0, yOffset = 0) => {\n      if (o._stage) a = this.compensateForStageSize(o);\n      //b.x = (a.x + a.halfWidth - b.halfWidth) + xOffset;\n      b.x = (a.x + nudgeAnchor(a, a.halfWidth, \"x\") - nudgeAnchor(b, b.halfWidth, \"x\")) + xOffset;\n      //b.y = (a.y + a.height) + yOffset;\n      b.y = (a.y + nudgeAnchor(a, a.height, \"y\")) + yOffset + compensateForAnchors(a, b, \"height\", \"y\");\n\n      //Compensate for the parent's position\n      if (!o._stage) o.compensateForParentPosition(a, b);\n    };\n\n    //`compensateForParentPosition` is a helper function for the above\n    //`put` methods that subracts the parent's global position from\n    //the nested child's position.\n    o.compensateForParentPosition = (a, b) => {\n      if (b.parent.gx !== 0 || b.parent.gy !== 0) {\n        b.x -= a.gx;\n        b.y -= a.gy;\n      }\n    };\n\n    let self = this;\n    Object.defineProperties(o, {\n      \"gx\": {\n        get() {\n          return o.getGlobalPosition().x\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"gy\": {\n        get() {\n          return o.getGlobalPosition().y\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"centerX\": {\n        get() {\n          return o.x + (o.width / 2) - o.xAnchorOffset\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"centerY\": {\n        get() {\n          return o.y + (o.height / 2) - o.yAnchorOffset\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"halfWidth\": {\n        get() {\n          return o.width / 2\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"halfHeight\": {\n        get() {\n          return o.height / 2\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"scaleModeNearest\": {\n        set(value) {\n          if (o.texture.baseTexture) {\n            if (value) {\n              o.texture.baseTexture.scaleMode = PIXI.SCALE_MODES.NEAREST;\n            } else {\n              o.texture.baseTexture.scaleMode = PIXI.SCALE_MODES.LINEAR;\n            }\n          } else {\n            throw new Error(`The scale mode of ${o} cannot be modified`)\n          }\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"pivotX\": {\n        get() {\n          return o.anchor.x\n        },\n        set(value) {\n          if (o.anchor === undefined) {\n            throw new Error(`${o} does not have a PivotX value`);\n          }\n          o.anchor.x = value;\n          if (!o._previousPivotX) {\n            o.x += value * o.width;\n          } else {\n            o.x += (value - o._previousPivotX) * o.width;\n          }\n          o._previousPivotX = value;\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"pivotY\": {\n        get() {\n          return o.anchor.y\n        },\n        set(value) {\n          if (o.anchor === undefined) {\n            throw new Error(`${o} does not have a PivotY value`);\n          }\n          o.anchor.y = value;\n          if (!o._previousPivotY) {\n            o.y += value * o.height;\n          } else {\n            o.y += (value - o._previousPivotY) * o.height;\n          }\n          o._previousPivotY = value;\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"xAnchorOffset\": {\n        get() {\n          if (o.anchor !== undefined) {\n            return o.height * o.anchor.x;\n          } else {\n            return 0;\n          }\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"yAnchorOffset\": {\n        get() {\n          if (o.anchor !== undefined) {\n            return o.width * o.anchor.y;\n          } else {\n            return 0;\n          }\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"scaleX\": {\n        get() {\n          return o.scale.x\n        },\n        set(value) {\n          o.scale.x = value;\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"scaleY\": {\n        get() {\n          return o.scale.y\n        },\n        set(value) {\n          o.scale.y = value;\n        },\n        enumerable: true,\n        configurable: true\n      },\n\n      //Depth layer\n      \"layer\": {\n        get() {\n          return o._layer\n        },\n        set(value) {\n          o._layer = value;\n          if (o.parent) {\n\n            //Sort the sprites parents `children` array so that sprites with a\n            //higher `layer` value are moved to the end of the array\n            o.parent.children.sort((a, b) => a.layer - b.layer);\n          }\n        },\n        enumerable: true,\n        configurable: true\n      },\n\n      //Interactivity\n      \"interact\": {\n        get() {\n          return o._interact\n        },\n        set(value) {\n          if (value === true) {\n            if (!o._interact) {\n              self.makeInteractive(o);\n              o._interact = true;\n            }\n          } else {\n            if (self.tink.buttons.indexOf(o) !== -1) {\n              self.tink.buttons.splice(self.tink.buttons.indexOf(o), 1);\n              o._interact = false;\n            }\n          }\n        },\n        enumerable: true,\n        configurable: true\n      },\n\n      //Drag and drop\n      \"draggable\": {\n        get() {\n          return o._draggable\n        },\n        set(value) {\n          if (value === true) {\n            if (!o._draggable) {\n              self.makeDraggable(o);\n              o._draggable = true;\n            }\n          } else {\n            self.makeUndraggable(o)\n            o._draggable = false;\n          }\n        },\n        enumerable: true,\n        configurable: true\n      },\n\n      //The `localBounds` and `globalBounds` methods return an object\n      //with `x`, `y`, `width`, and `height` properties that define\n      //the dimensions and position of the sprite. This is a convenience\n      //to help you set or test boundaries without having to know\n      //these numbers or request them specifically in your code.\n      \"localBounds\": {\n        get() {\n          return {\n            x: 0,\n            y: 0,\n            width: o.width,\n            height: o.height\n          };\n        },\n        enumerable: true,\n        configurable: true\n      },\n      \"globalBounds\": {\n        get() {\n          return {\n            x: o.gx,\n            y: o.gy,\n            width: o.gx + o.width,\n            height: o.gy + o.height\n          };\n        },\n        enumerable: true,\n        configurable: true\n      },\n\n      //`empty` is a convenience property that will return `true` or\n      //`false` depending on whether or not this sprite's `children`\n      //array is empty\n      \"empty\": {\n        get() {\n          if (o.children.length === 0) {\n            return true;\n          } else {\n            return false;\n          }\n        },\n        enumerable: true,\n        configurable: true\n      },\n\n      //The `circular` property lets you define whether a sprite\n      //should be interpreted as a circular object. If you set\n      //`circular` to `true`, the sprite is given `radius` and `diameter`\n      //properties. If you set `circular` to `false`, the `radius`\n      //and `diameter` properties are deleted from the sprite\n      \"circular\": {\n        get() {\n          return o._circular;\n        },\n        set(value) {\n\n          //Give the sprite `diameter` and `radius` properties\n          //if `circular` is `true`\n          if (value === true && o._circular === false) {\n            Object.defineProperties(o, {\n              \"diameter\": {\n                get() {\n                  return o.width;\n                },\n                set(value) {\n                  o.width = value;\n                  o.height = value;\n                },\n                enumerable: true,\n                configurable: true\n              },\n              \"radius\": {\n                get() {\n                  return o.halfWidth;\n                },\n                set(value) {\n                  o.width = value * 2;\n                  o.height = value * 2;\n                },\n                enumerable: true,\n                configurable: true\n              }\n            });\n\n            //Set o.sprite's `_circular` property to `true`\n            o._circular = true;\n          }\n\n          //Remove the sprite's `diameter` and `radius` properties\n          //if `circular` is `false`\n          if (value === false && o._circular === true) {\n            delete o.diameter;\n            delete o.radius;\n            o._circular = false;\n          }\n        },\n        enumerable: true,\n        configurable: true\n      }\n    });\n\n    //A `setPosition` convenience method to let you set the\n    //x any y position of a sprite with one line of code.\n    o.setPosition = (x, y) => {\n      o.x = x;\n      o.y = y;\n    };\n\n    //A similar `setScale` convenience method\n    o.setScale = (xScale, yScale) => {\n      o.scale.x = xScale;\n      o.scale.y = yScale;\n    };\n\n    //And a matching `setPivot` method\n    o.setPivot = (xPivot, yPivot) => {\n      o.pivotX = xPivot;\n      o.pivotY = yPivot;\n    };\n\n    if (o.circular) {\n      Object.defineProperty(o, \"radius\", {\n        get() {\n          return o.width / 2\n        },\n        enumerable: true,\n        configurable: true\n      });\n    }\n\n  }\n\n  //8. Utilities\n\n  //A method to scale and align the canvas in the browser\n  //window using the `scaleToWindow.js` function module\n  scaleToWindow(scaleBorderColor = \"#2C3539\") {\n\n    //Set the default CSS padding and margins of HTML elements to 0 \n    //<style>* {padding: 0; margin: 0}</style>\n    let newStyle = document.createElement(\"style\");\n    let style = \"* {padding: 0; margin: 0}\";\n    newStyle.appendChild(document.createTextNode(style));\n    document.head.appendChild(newStyle);\n\n    //Use the `scaleToWindow` function module to scale the canvas to\n    //the maximum window size\n    this.scale = scaleToWindow(this.canvas, scaleBorderColor);\n    console.log(\"new scale: \" + this.scale)\n    this.pointer.scale = this.scale;\n    //this.pointer = this.makePointer(this.canvas, this.scale);\n    console.log(this.pointer)\n\n    //Re-scale on each browser resize\n    window.addEventListener(\"resize\", event => {\n      //Scale the canvas and update Hexi's global `scale` value and\n      //the pointer's `scale` value\n      this.scale = scaleToWindow(this.canvas, scaleBorderColor);\n      this.pointer.scale = this.scale;\n    });\n\n    //Flag that the canvas has been scaled\n    this.canvas.scaled = true;\n  }\n\n  //`log` is a shortcut for `console.log`, so that you have less to\n  //type when you're debugging\n  log(value) {\n    return console.log(value);\n  }\n\n  //The `makeProgressBar` method creates a `progressBar` object with\n  //`create`, `update` and `remove` methods. It's called by the\n  //`loadingBar` method, which should be run inside the `load`\n  //function of your application code. \n  makeProgressBar(hexiObject) {\n\n    let hexi = hexiObject;\n\n    //The `progressBar` object\n    hexi.progressBar = {\n      maxWidth: 0,\n      height: 0,\n      backgroundColor: \"0x808080\",\n      foregroundColor: \"0x00FFFF\",\n      backBar: null,\n      frontBar: null,\n      percentage: null,\n      assets: null,\n      initialized: false,\n\n      //Use the `create` method to create the progress bar\n      create() {\n\n        //Set the maximum width to half the width of the canvas\n        this.maxWidth = hexi.canvas.width / 2;\n\n        //Build the progress bar using two rectangle sprites and\n        //one text sprite\n\n        //1. Create the background bar's gray background\n        this.backBar = hexi.rectangle(this.maxWidth, 32, this.backgroundColor);\n        this.backBar.x = (hexi.canvas.width / 2) - (this.maxWidth / 2);\n        this.backBar.y = (hexi.canvas.height / 2) - 16;\n\n        //2. Create the blue foreground bar. This is the element of the\n        //progress bar that will increase in width as assets load\n        this.frontBar = hexi.rectangle(this.maxWidth, 32, this.foregroundColor);\n        this.frontBar.x = (hexi.canvas.width / 2) - (this.maxWidth / 2);\n        this.frontBar.y = (hexi.canvas.height / 2) - 16;\n\n        //3. A text sprite that will display the percentage\n        //of assets that have loaded\n        this.percentage = hexi.text(\"0%\", \"28px sans-serif\", \"black\");\n        this.percentage.x = (hexi.canvas.width / 2) - (this.maxWidth / 2) + 12;\n        this.percentage.y = (hexi.canvas.height / 2) - 17;\n      },\n\n      //Use the `update` method to update the width of the bar and \n      //percentage loaded each frame\n      update() {\n\n        //Change the width of the blue `frontBar` to match the\n        //ratio of assets that have loaded.\n        let ratio = hexi.loadingProgress / 100;\n        //console.log(`ratio: ${ratio}`);\n        this.frontBar.width = this.maxWidth * ratio;\n\n        //Display the percentage\n        this.percentage.content = `${Math.round(hexi.loadingProgress)} %`;\n      },\n\n      //Use the `remove` method to remove the progress bar when all the\n      //game assets have finished loading\n      remove() {\n\n        //Remove the progress bar using the universal sprite `remove`\n        //function\n        hexi.stage.removeChild(this.frontBar);\n        hexi.stage.removeChild(this.backBar);\n        hexi.stage.removeChild(this.percentage);\n      }\n    };\n  }\n\n  //The `loadingBar` method should be called inside the user-definable\n  //`load` method in the application code. This function will run in a\n  //loop. It will create the loading bar, and then call the loading\n  //bar's `update` method each frame. After all the assets have been\n  //loaded, Hexi's `validateAssets` method removes the loading bar. \n  loadingBar() {\n\n    if (!this._progressBarAdded) {\n\n      //Run the method that creates the progress bar object\n      this.makeProgressBar(this);\n\n      //Create the loading bar\n      this.progressBar.create();\n\n      //Tell Hexi that a progress bar has been added\n      this._progressBarAdded = true;\n    } else {\n\n      //Update the progress bar each frame\n      this.progressBar.update();\n    }\n  }\n\n  //Hexi's root `stage` object will have a width and height equal to\n  //its contents, not the size of the canvas. So, let's use the more\n  //useful canvas width and height for relative positioning instead \n  compensateForStageSize(o) {\n    if (o._stage === true) {\n      let a = {};\n      a.x = 0;\n      a.y = 0;\n      a.width = this.canvas.width;\n      a.height = this.canvas.height;\n      a.halfWidth = this.canvas.width / 2;\n      a.halfHeight = this.canvas.height / 2;\n      a.xAnchorOffset = 0;\n      a.yAnchorOffset = 0;\n      return a;\n    }\n  }\n\n  //High level functions for accessing the loaded resources and custom parsed\n  //objects, like sounds.\n  image(imageFileName) {\n    if (this.TextureCache[imageFileName]) {\n      return this.TextureCache[imageFileName];\n    } else {\n      throw new Error(`${imageFileName} does not appear to be an image`);\n    }\n  }\n  id(textureAtlasFrameId) {\n    if (this.TextureCache[textureAtlasFrameId]) {\n      return this.TextureCache[textureAtlasFrameId];\n    } else {\n      throw new Error(`${textureAtlasFrameId} does not appear to be a texture atlas frame id`);\n    }\n  }\n  json(jsonFileName) {\n    if (this.loader.resources[jsonFileName].data) {\n      return this.resources[jsonFileName].data;\n    } else {\n      throw new Error(`${jsonFileName} does not appear to be a JSON data file`);\n    }\n  }\n  xml(xmlFileName) {\n    if (this.loader.resources[xmlFileName].data) {\n      return this.resources[xmlFileName].data;\n    } else {\n      throw new Error(`${xmlFileName} does not appear to be a XML data file`);\n    }\n  }\n  sound(soundFileName) {\n    if (this.soundObjects[soundFileName]) {\n      return this.soundObjects[soundFileName];\n    } else {\n      throw new Error(`${soundFileName} does not appear to be a sound object`);\n    }\n  }\n}"]}